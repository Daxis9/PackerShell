{
    "variables": {
      "vm_name": "windows2016",
      "default_disk_size": "40960",
      "default_cpus": "2",
      "default_memory": "4096",
      "default_generation": "2"
    },
    "builders": [
      {
        "vm_name": "{{user `vm_name`}}",
        "type": "hyperv-iso",
        "disk_size": "{{user `default_disk_size`}}",
        "boot_wait": "0s",
        "boot_command": [
          "a<wait>a<wait>a"
        ],
        "iso_url": "\\\\itsys-vmm-mgmt1.ad.siu.edu\\MSSCVMMLibrary$\\ISOs\\Windows\\Server",
        "iso_checksum": "E3779D4B1574BF711B063FE457B3BA63",
        "communicator": "winrm",
        "winrm_username": "vagrant",
        "winrm_password": "vagrant",
        "winrm_timeout" : "4h",
        "shutdown_command": "f:\\run-sysprep.cmd",
        "memory": "{{user `default_memory`}}",
        "cpus": "{{user `default_cpus`}}",
        "generation": "{{user `default_generation`}}",
        "enable_secure_boot":true
      }
    ],
    "provisioners": [
      {
        "type": "powershell",
        "elevated_user":"vagrant",
        "elevated_password":"vagrant",
        "scripts": [
        ]
      },
      {
        "type": "ansible",
        "playbook_file": "./playbook.yml",
        "extra_arguments": [
          "--connection", "packer", "--extra-vars", "ansible_shell_type=powershell ansible_shell_executable=None"
        ]
      }
    ],
    "post-processors": [
      {
        "type": "vagrant",
        "keep_input_artifact": false,
        "output": "{{.Provider}}_WS2016_{{}}.box"
      }
    ]
  }